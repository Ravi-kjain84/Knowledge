import win32com.client

# Path to the Excel file
file_path = r'C:\path\to\your\file.xlsm'

# Open Excel
excel = win32com.client.Dispatch("Excel.Application")
excel.Visible = True

# Open the workbook
workbook = excel.Workbooks.Open(file_path)

# Run the macro (use the exact macro name)
macro_name = 'Module1.MacroName'  # Format: ModuleName.MacroName
excel.Application.Run(macro_name)

# Save and close workbook
workbook.Save()
workbook.Close()

# Quit Excel
excel.Quit()

print("Macro executed successfully!")
